<ion-header mode="md">
  <ion-toolbar>
    <ion-title slot="start">
      Add an <br />
      Excercise
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="close()">cancel</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="false">
  <ion-row class="srch">
    <ion-col size="10">
      <ion-searchbar
        [(ngModel)]="exerciseFilters.exerciseName"
        class="srchBar"
        placeholder="Search for a workout"
        (ionInput)="onSearch()"
      ></ion-searchbar>
    </ion-col>
    <ion-col size="2">
      <ion-button (click)="onPresentSearchExerciceFiltersModal()">
        <ion-icon name="options"></ion-icon>
      </ion-button>
    </ion-col>
  </ion-row>

  <!-- SEARCH form -->
  <!-- <form [formGroup]="form">
    <ion-row>
      <ion-col size="5">
        <ion-item class="input">
          <ion-input formControlName="name" placeholder="Name"></ion-input>
        </ion-item>
      </ion-col>
      <ion-col size="5">
        <ion-item class="select">
          <ion-select formControlName="muscle" placeholder="Muscle used">
            <ion-select-option [value]="''">Any</ion-select-option>
            @for (muscle of musclePossibleValues; track $index) {
            <ion-select-option [value]="muscle">{{
              muscle.charAt(0).toUpperCase() + muscle.slice(1)
            }}</ion-select-option>
            }
          </ion-select>
        </ion-item>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="5">
        <ion-item class="select">
          <ion-select formControlName="category" placeholder="Category">
            <ion-select-option [value]="''">Any</ion-select-option>
            @for (category of categoryPossibleValues; track $index) {
            <ion-select-option [value]="category">{{
              category.charAt(0).toUpperCase() + category.slice(1)
            }}</ion-select-option>
            }
          </ion-select>
        </ion-item>
      </ion-col>
      <ion-col size="5">
        <ion-item class="select">
          <ion-select formControlName="equipment" placeholder="Equipment">
            <ion-select-option [value]="''">Any</ion-select-option>
            @for (eq of equipmentPossibleValues; track $index) {
            <ion-select-option [value]="eq">{{
              eq.charAt(0).toUpperCase() + eq.slice(1)
            }}</ion-select-option>
            }
          </ion-select>
        </ion-item>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col size="5">
        <ion-item class="select">
          <ion-select formControlName="level" placeholder="Level">
            <ion-select-option [value]="''">Any</ion-select-option>
            @for (level of levelPossibleValues; track $index) {
            <ion-select-option [value]="level">{{
              level.charAt(0).toUpperCase() + level.slice(1)
            }}</ion-select-option>
            }
          </ion-select>
        </ion-item>
      </ion-col>
      <ion-col size="3">
        <ion-item class="searchButton" (click)="onSearch()">
          <ion-button>
            <ion-icon name="search-outline"></ion-icon>
          </ion-button>
        </ion-item>
      </ion-col>
    </ion-row>
  </form> -->

  @defer (when !isLoading) {
  <div class="exercisesDiv">
    <ion-list class="exercises">
      @for (exercise of exercises; track exercise.id) {
      <ion-item>
        <img [src]="gifBaseUrl + exercise.id + '/exercise.gif'" />

        <ion-label class="ion-text-wrap">
          <h3>{{ exercise.name }}</h3>
          @for (pm of exercise.primaryMuscles; track $index; let isLast =
          $last;) {
          <p>{{ pm }} {{ !isLast ? "|" : "" }}</p>
          }
        </ion-label>

        <ion-checkbox
          aria-label=""
          (ionChange)="onExerciseCheckboxClicked(exercise)"
          slot="end"
          class="exerciseCheck"
          [id]="exercise.id"
          [disabled]="
            exercise.id != selectedExercise?.id && selectedExercise != null
          "
        >
        </ion-checkbox>
      </ion-item>

      } @empty { @if(!isLoading){
      <ion-item lines="none">
        <ion-label class="ion-text-center"> No exercises found. </ion-label>
      </ion-item>
      } }
    </ion-list>
  </div>

  @if(loadMoreExercisesButtonVisibile){
  <ion-item>
    <ion-button (click)="loadMore()">Load more exercises</ion-button>
  </ion-item>
  } }@placeholder {
  <ion-list>
    @for (item of dummyArray; track item) {
    <ion-item lines="none" class="ion-padding-bottom">
      <ion-avatar slot="start">
        <ion-skeleton-text></ion-skeleton-text>
      </ion-avatar>
      <ion-skeleton-text animated style="height: 40px"></ion-skeleton-text>
    </ion-item>
    }
  </ion-list>
  } @error {
  <ion-alert
    header="Error"
    [message]="error"
    isOpen="true"
    [buttons]="['Ok']"
  />
  }
  <form [formGroup]="formRepsDuration">
    <ion-list class="repsList" lines="none" mode="ios">
      <ion-item class="checkbox">
        <ion-checkbox
          (ionChange)="repsCheck = !repsCheck"
          [checked]="repsCheck"
          id="repsCheck"
          labelPlacement="end"
          justify="start"
          >Reps:</ion-checkbox
        >
      </ion-item>
      <ion-item class="input">
        <ion-input
          formControlName="reps"
          [attr.disabled]="!repsCheck"
          id="repsInput"
          type="number"
          placeholder="number"
        ></ion-input>
      </ion-item>
    </ion-list>

    <ion-list class="durList" lines="none" mode="ios">
      <ion-item class="checkbox">
        <ion-checkbox
          (ionChange)="repsCheck = !repsCheck"
          [checked]="!repsCheck"
          size="medium"
          id="durationCheck"
          labelPlacement="end"
          justify="start"
          >Duration:</ion-checkbox
        >
      </ion-item>
      <ion-item class="input">
        <ion-input
          [attr.disabled]="repsCheck"
          type="number"
          label="min"
          labelPlacement="floating"
          id="minInput"
          formControlName="durationMin"
        ></ion-input>
        <ion-input
          [attr.disabled]="repsCheck"
          type="number"
          label="sec"
          labelPlacement="floating"
          id="secInput"
          formControlName="durationSec"
        ></ion-input>
      </ion-item>
    </ion-list>
  </form>

  <ion-button
    class="addToSet"
    expand="block"
    shape="round"
    size="medium"
    (click)="onAddExercise()"
  >
    <ion-text> <strong>Add to set</strong> </ion-text>
  </ion-button>
</ion-content>
